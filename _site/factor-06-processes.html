<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factor 6: Processes | The Modern 17-Factor App</title>
    <meta name="description" content="Execute the app as one or more stateless processes">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/12-factor-app-website/assets/css/main.css">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SEO -->
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Factor 6: Processes | The Modern 17-Factor App</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Factor 6: Processes" />
<meta name="author" content="Pierre Brunelle" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Execute the app as one or more stateless processes" />
<meta property="og:description" content="Execute the app as one or more stateless processes" />
<link rel="canonical" href="https://pierrebrunelle.github.io/12-factor-app-website/factor-06-processes.html" />
<meta property="og:url" content="https://pierrebrunelle.github.io/12-factor-app-website/factor-06-processes.html" />
<meta property="og:site_name" content="The Modern 17-Factor App" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Factor 6: Processes" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Pierre Brunelle"},"description":"Execute the app as one or more stateless processes","headline":"Factor 6: Processes","url":"https://pierrebrunelle.github.io/12-factor-app-website/factor-06-processes.html"}</script>
<!-- End Jekyll SEO tag -->

    
    <!-- Feed -->
    <link type="application/atom+xml" rel="alternate" href="https://pierrebrunelle.github.io/12-factor-app-website/feed.xml" title="The Modern 17-Factor App" />
</head>
<body>
    <!-- Skip to main content link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="/12-factor-app-website/" class="brand-link" aria-label="The Modern 17-Factor App - Home">
                    <i class="fas fa-cube brand-icon" aria-hidden="true"></i>
                    <span class="brand-text">The Modern 17-Factor App</span>
                </a>
            </div>
            
            <div class="nav-menu" id="nav-menu" role="menubar">
                <a href="/12-factor-app-website/" class="nav-link " role="menuitem" aria-current="">
                    <i class="fas fa-home" aria-hidden="true"></i> Home
                </a>
                <div class="nav-dropdown" role="menuitem">
                    <a href="#" class="nav-link dropdown-toggle" aria-expanded="false" aria-haspopup="true" role="button" aria-label="Factors menu">
                        <i class="fas fa-list" aria-hidden="true"></i> Factors <i class="fas fa-chevron-down" aria-hidden="true"></i>
                    </a>
                    <div class="dropdown-content" role="menu" aria-label="Factors submenu">
                        <div class="dropdown-section">
                            <h4 role="presentation">Original 12 Factors</h4>
                            <a href="/12-factor-app-website/factor-01-codebase" role="menuitem">1. Codebase</a>
                            <a href="/12-factor-app-website/factor-02-dependencies" role="menuitem">2. Dependencies</a>
                            <a href="/12-factor-app-website/factor-03-config" role="menuitem">3. Config</a>
                            <a href="/12-factor-app-website/factor-04-backing-services" role="menuitem">4. Backing Services</a>
                            <a href="/12-factor-app-website/factor-05-build-release-run" role="menuitem">5. Build, Release, Run</a>
                            <a href="/12-factor-app-website/factor-06-processes" role="menuitem">6. Processes</a>
                            <a href="/12-factor-app-website/factor-07-port-binding" role="menuitem">7. Port Binding</a>
                            <a href="/12-factor-app-website/factor-08-concurrency" role="menuitem">8. Concurrency</a>
                            <a href="/12-factor-app-website/factor-09-disposability" role="menuitem">9. Disposability</a>
                            <a href="/12-factor-app-website/factor-10-dev-prod-parity" role="menuitem">10. Dev/Prod Parity</a>
                            <a href="/12-factor-app-website/factor-11-logs" role="menuitem">11. Logs</a>
                            <a href="/12-factor-app-website/factor-12-admin-processes" role="menuitem">12. Admin Processes</a>
                        </div>
                        <div class="dropdown-section">
                            <h4 role="presentation">New 6 Factors</h4>
                            <a href="/12-factor-app-website/factor-13-api-first" role="menuitem">13. API First</a>
                            <a href="/12-factor-app-website/factor-14-telemetry" role="menuitem">14. Telemetry</a>
                            <a href="/12-factor-app-website/factor-15-graphql-grpc" role="menuitem">15. GraphQL & gRPC</a>
                            <a href="/12-factor-app-website/factor-16-auth" role="menuitem">16. Authentication & Authorization</a>
                            <a href="/12-factor-app-website/factor-17-event-driven" role="menuitem">17. Event-Driven Architecture</a>
                            <a href="/12-factor-app-website/factor-18-failure-isolation" role="menuitem">18. Failure Isolation</a>
                        </div>
                    </div>
                </div>
                <a href="https://github.com/ifeatu/12-factor-app-website" target="_blank" class="nav-link" role="menuitem" aria-label="GitHub repository (opens in new tab)">
                    <i class="fab fa-github" aria-hidden="true"></i> GitHub
                </a>
            </div>
            
            <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="nav-menu">
                <span class="bar" aria-hidden="true"></span>
                <span class="bar" aria-hidden="true"></span>
                <span class="bar" aria-hidden="true"></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="main-content">
        <div class="factor-page">
    <!-- Factor Header -->
    <div class="factor-header">
        <div class="container">
            <div class="factor-nav">
                <a href="/12-factor-app-website/" class="back-link" aria-label="Back to overview page">
                    <i class="fas fa-arrow-left" aria-hidden="true"></i> Back to Overview
                </a>
                
                <nav class="factor-navigation" aria-label="Factor navigation">
                    
                        <a href="/12-factor-app-website/factor-05-build-release-run" class="nav-btn prev-btn" aria-label="Previous factor: Build, Release, Run">
                            <i class="fas fa-chevron-left" aria-hidden="true"></i> Previous
                        </a>
                    
                    
                    
                        <a href="/12-factor-app-website/factor-07-port-binding" class="nav-btn next-btn" aria-label="Next factor: Port Binding">
                            Next <i class="fas fa-chevron-right" aria-hidden="true"></i>
                        </a>
                    
                </nav>
            </div>
            
            <div class="factor-title">
                
                
                    <div class="factor-number-circle">6</div>
                    <h1 class="factor-name">Processes</h1>
                
                
                
                    <p class="factor-description">Execute the app as one or more stateless processes</p>
                
            </div>
        </div>
    </div>

    <!-- Factor Content -->
    <div class="factor-content">
        <div class="container">
            <div class="content-wrapper">
                <!-- Table of Contents -->
                <aside class="toc-sidebar" role="complementary" aria-label="Table of contents">
                    <div class="toc-container">
                        <h3>Table of Contents</h3>
                        <div id="toc"></div>
                    </div>
                </aside>
                
                <!-- Main Content -->
                <article class="factor-article" role="main">
                    <h1 id="factor-6-processes">Factor 6: Processes</h1>

<h2 id="execute-the-app-as-one-or-more-stateless-processes">Execute the app as one or more stateless processes</h2>

<h3 id="original-principle">Original Principle</h3>

<p>Twelve-factor processes are stateless and share-nothing. Any data that needs to persist must be stored in a stateful backing service, typically a database. The memory space or filesystem of the process can be used as a brief, single-transaction cache.</p>

<h3 id="modern-evolution">Modern Evolution</h3>

<p>While statelessness remains a cornerstone of scalable applications, modern architectures have introduced sophisticated patterns for managing necessary state. The evolution includes distributed caching, event sourcing, and coordinated state management that maintain the spirit of statelessness while addressing real-world requirements.</p>

<h4 id="the-reality-of-state-in-distributed-systems">The Reality of State in Distributed Systems</h4>

<p>Modern applications often require:</p>
<ul>
  <li><strong>Session affinity</strong> for WebSocket connections</li>
  <li><strong>Local caches</strong> for performance optimization</li>
  <li><strong>In-memory computation</strong> for stream processing</li>
  <li><strong>Distributed consensus</strong> for coordination</li>
</ul>

<p>The key is <strong>externalizing state</strong> while maintaining process independence:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Bad: Storing state in process memory
</span><span class="k">class</span> <span class="nc">BadUserService</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">user_cache</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Will be lost on restart!
</span>    
    <span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">user_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">user_cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">user_cache</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="n">fetch_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">user_cache</span><span class="p">[</span><span class="n">user_id</span><span class="p">]</span>

<span class="c1"># Good: Externalized state with Redis
</span><span class="k">class</span> <span class="nc">GoodUserService</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">redis</span> <span class="o">=</span> <span class="n">redis</span><span class="p">.</span><span class="n">Redis</span><span class="p">.</span><span class="n">from_url</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'REDIS_URL'</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="n">cached</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">redis</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s">"user:</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">cached</span><span class="p">)</span>
        
        <span class="n">user</span> <span class="o">=</span> <span class="n">db</span><span class="p">.</span><span class="n">fetch_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">redis</span><span class="p">.</span><span class="n">setex</span><span class="p">(</span>
            <span class="sa">f</span><span class="s">"user:</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
            <span class="mi">300</span><span class="p">,</span>  <span class="c1"># 5-minute TTL
</span>            <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span>
</code></pre></div></div>

<h4 id="modern-state-management-patterns">Modern State Management Patterns</h4>

<ol>
  <li><strong>Distributed Caching</strong>
```</li>
</ol>

<h3 id="implementation-guidelines">Implementation Guidelines</h3>

<ol>
  <li><strong>Stateless Process Design</strong>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Stateless worker process
</span><span class="k">class</span> <span class="nc">Worker</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># All state in external services
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">create_db_connection</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">create_redis_connection</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">queue</span> <span class="o">=</span> <span class="n">create_sqs_connection</span><span class="p">()</span>
       
    <span class="k">def</span> <span class="nf">process_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="c1"># No local state persists between messages
</span>        <span class="n">context</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">load_context</span><span class="p">(</span><span class="n">message</span><span class="p">.</span><span class="n">context_id</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">perform_work</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">save_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
           
        <span class="c1"># Clean up any temporary data
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">cleanup_temp_files</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Horizontal Scaling Pattern</strong>
```yaml
    <h1 id="kubernetes-hpa-for-stateless-scaling">Kubernetes HPA for stateless scaling</h1>
    <p>apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: worker-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: worker
  minReplicas: 2
  maxReplicas: 100
  metrics:</p>
    <ul>
      <li>type: Resource
resource:
  name: cpu
  target:
    type: Utilization
    averageUtilization: 70</li>
      <li>type: Pods
pods:
  metric:
    name: pending_jobs
  target:
    type: AverageValue
    averageValue: “30”
```</li>
    </ul>
  </li>
  <li><strong>Session Management</strong>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Express session with Redis store</span>
<span class="kd">const</span> <span class="nx">session</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express-session</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">RedisStore</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">connect-redis</span><span class="dl">'</span><span class="p">)(</span><span class="nx">session</span><span class="p">);</span>
   
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">session</span><span class="p">({</span>
  <span class="na">store</span><span class="p">:</span> <span class="k">new</span> <span class="nx">RedisStore</span><span class="p">({</span>
    <span class="na">client</span><span class="p">:</span> <span class="nx">redisClient</span><span class="p">,</span>
    <span class="na">prefix</span><span class="p">:</span> <span class="dl">'</span><span class="s1">session:</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">ttl</span><span class="p">:</span> <span class="mi">86400</span>  <span class="c1">// 24 hours</span>
  <span class="p">}),</span>
  <span class="na">secret</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SESSION_SECRET</span><span class="p">,</span>
  <span class="na">resave</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">saveUninitialized</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="na">cookie</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">secure</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">httpOnly</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">maxAge</span><span class="p">:</span> <span class="mi">86400000</span>
  <span class="p">}</span>
<span class="p">}));</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="best-practices">Best Practices</h3>

<ol>
  <li><strong>Ephemeral File System</strong>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">os</span>
   
<span class="k">def</span> <span class="nf">process_upload</span><span class="p">(</span><span class="n">file_data</span><span class="p">):</span>
    <span class="c1"># Use temp directory that's cleaned automatically
</span>    <span class="k">with</span> <span class="n">tempfile</span><span class="p">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp</span><span class="p">:</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_data</span><span class="p">)</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
           
        <span class="c1"># Process file
</span>        <span class="n">result</span> <span class="o">=</span> <span class="n">process_file</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>
           
        <span class="c1"># File automatically deleted when context exits
</span>       
    <span class="c1"># Store results in object storage
</span>    <span class="n">s3</span><span class="p">.</span><span class="n">upload_fileobj</span><span class="p">(</span>
        <span class="n">io</span><span class="p">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">result</span><span class="p">),</span>
        <span class="s">'my-bucket'</span><span class="p">,</span>
        <span class="sa">f</span><span class="s">'results/</span><span class="si">{</span><span class="n">uuid</span><span class="p">.</span><span class="n">uuid4</span><span class="p">()</span><span class="si">}</span><span class="s">.json'</span>
    <span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Distributed Work Queues</strong>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Celery for distributed task processing
</span><span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">Celery</span>
   
<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s">'tasks'</span><span class="p">,</span> <span class="n">broker</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'REDIS_URL'</span><span class="p">])</span>
   
<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">task</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_id</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Stateless processing
</span>        <span class="n">order</span> <span class="o">=</span> <span class="n">fetch_order</span><span class="p">(</span><span class="n">order_id</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">process_payment</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="n">send_confirmation</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="c1"># Retry with exponential backoff
</span>        <span class="k">raise</span> <span class="bp">self</span><span class="p">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exc</span><span class="o">=</span><span class="n">exc</span><span class="p">,</span> <span class="n">countdown</span><span class="o">=</span><span class="mi">2</span> <span class="o">**</span> <span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">retries</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Cache-Aside Pattern</strong>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CacheAsideService</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">Redis</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">Database</span><span class="p">()</span>
       
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="c1"># Try cache first
</span>        <span class="n">cached</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">cache</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cached</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">cached</span><span class="p">)</span>
           
        <span class="c1"># Load from database
</span>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">db</span><span class="p">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
           
        <span class="c1"># Update cache for next time
</span>        <span class="k">await</span> <span class="bp">self</span><span class="p">.</span><span class="n">cache</span><span class="p">.</span><span class="n">setex</span><span class="p">(</span>
            <span class="n">key</span><span class="p">,</span>
            <span class="mi">300</span><span class="p">,</span>  <span class="c1"># 5 minute TTL
</span>            <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="p">)</span>
           
        <span class="k">return</span> <span class="n">data</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="anti-patterns-to-avoid">Anti-Patterns to Avoid</h3>

<ul>
  <li><strong>In-memory state</strong> between requests</li>
  <li><strong>Local file storage</strong> for persistent data</li>
  <li><strong>Sticky sessions</strong> without external session store</li>
  <li><strong>Process-specific</strong> configuration</li>
  <li><strong>Stateful singletons</strong> in application code</li>
</ul>

<h3 id="modern-tools-and-services">Modern Tools and Services</h3>

<ul>
  <li><strong>Distributed Cache</strong>: Redis, Memcached, Hazelcast</li>
  <li><strong>Session Stores</strong>: Redis, DynamoDB, Memcached</li>
  <li><strong>Message Queues</strong>: RabbitMQ, AWS SQS, Google Pub/Sub</li>
  <li><strong>Stream Processing</strong>: Apache Kafka, Apache Pulsar</li>
  <li><strong>Coordination</strong>: Apache Zookeeper, etcd, Consul</li>
</ul>

<h3 id="key-takeaways">Key Takeaways</h3>

<ol>
  <li>Stateless processes enable horizontal scaling</li>
  <li>Externalize all persistent state to backing services</li>
  <li>Use distributed caching for performance</li>
  <li>Session affinity requires external session stores</li>
  <li>Event sourcing provides audit trails with stateless processing</li>
  <li>Temporary files should use ephemeral storage</li>
</ol>

<hr />

<h3 id="sources">Sources</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">https://12factor.net/processes</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://martinfowler.com/articles/microservices.html#DecentralizedDataManagement</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://redis.io/topics/distlock</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://kubernetes.io/docs/tasks/run-application/run-stateless-application-deployment/</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://docs.microsoft.com/en-us/azure/architecture/patterns/event-sourcing</code>yaml
 # Redis Cluster for high availability
 apiVersion: apps/v1
 kind: StatefulSet
 metadata:
   name: redis-cluster
 spec:
   serviceName: redis-cluster
   replicas: 6
   template:
     spec:
       containers:
       - name: redis
         image: redis:7-alpine
         command: [“redis-server”]
         args:
         - “–cluster-enabled yes”
         - “–cluster-config-file nodes.conf”
         - “–cluster-node-timeout 5000”
 ```</li>
</ul>

<ol>
  <li><strong>Event Sourcing</strong>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># State as a series of events
</span><span class="k">class</span> <span class="nc">EventStore</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kafka_producer</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">producer</span> <span class="o">=</span> <span class="n">kafka_producer</span>
       
    <span class="k">def</span> <span class="nf">append_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aggregate_id</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">send</span><span class="p">(</span>
            <span class="n">topic</span><span class="o">=</span><span class="sa">f</span><span class="s">"events.</span><span class="si">{</span><span class="n">event</span><span class="p">.</span><span class="n">aggregate_type</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="n">aggregate_id</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="p">{</span>
                <span class="s">"id"</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">.</span><span class="n">uuid4</span><span class="p">()),</span>
                <span class="s">"aggregate_id"</span><span class="p">:</span> <span class="n">aggregate_id</span><span class="p">,</span>
                <span class="s">"type"</span><span class="p">:</span> <span class="n">event</span><span class="p">.</span><span class="nb">type</span><span class="p">,</span>
                <span class="s">"data"</span><span class="p">:</span> <span class="n">event</span><span class="p">.</span><span class="n">data</span><span class="p">,</span>
                <span class="s">"timestamp"</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">utcnow</span><span class="p">().</span><span class="n">isoformat</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">)</span>
   
<span class="c1"># Rebuild state from events
</span><span class="k">def</span> <span class="nf">rebuild_aggregate_state</span><span class="p">(</span><span class="n">aggregate_id</span><span class="p">):</span>
    <span class="n">events</span> <span class="o">=</span> <span class="n">kafka_consumer</span><span class="p">.</span><span class="n">consume_all</span><span class="p">(</span>
        <span class="n">topic</span><span class="o">=</span><span class="s">"events.order"</span><span class="p">,</span>
        <span class="n">key</span><span class="o">=</span><span class="n">aggregate_id</span>
    <span class="p">)</span>
       
    <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">apply_event</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
       
    <span class="k">return</span> <span class="n">state</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Coordination with External State</strong>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Distributed locking with Redis
</span><span class="kn">import</span> <span class="nn">redlock</span>
   
<span class="n">dlm</span> <span class="o">=</span> <span class="n">redlock</span><span class="p">.</span><span class="n">Redlock</span><span class="p">([</span>
    <span class="p">{</span><span class="s">"host"</span><span class="p">:</span> <span class="s">"redis1.example.com"</span><span class="p">,</span> <span class="s">"port"</span><span class="p">:</span> <span class="mi">6379</span><span class="p">},</span>
    <span class="p">{</span><span class="s">"host"</span><span class="p">:</span> <span class="s">"redis2.example.com"</span><span class="p">,</span> <span class="s">"port"</span><span class="p">:</span> <span class="mi">6379</span><span class="p">},</span>
    <span class="p">{</span><span class="s">"host"</span><span class="p">:</span> <span class="s">"redis3.example.com"</span><span class="p">,</span> <span class="s">"port"</span><span class="p">:</span> <span class="mi">6379</span><span class="p">},</span>
<span class="p">])</span>
   
<span class="k">def</span> <span class="nf">process_job</span><span class="p">(</span><span class="n">job_id</span><span class="p">):</span>
    <span class="n">lock</span> <span class="o">=</span> <span class="n">dlm</span><span class="p">.</span><span class="n">lock</span><span class="p">(</span><span class="sa">f</span><span class="s">"job:</span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>  <span class="c1"># 10 second lock
</span>    <span class="k">if</span> <span class="n">lock</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Process job with exclusive access
</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">perform_work</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>
            <span class="n">save_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">dlm</span><span class="p">.</span><span class="n">unlock</span><span class="p">(</span><span class="n">lock</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

                    
                    <!-- Factor Navigation Footer -->
                    <nav class="factor-footer-nav" aria-label="Factor pagination">
                        
                            
                                <a href="/12-factor-app-website/factor-05-build-release-run" class="footer-nav-btn prev" aria-label="Previous: Factor 5 - Build, Release, Run">
                                    <div class="nav-direction">Previous Factor</div>
                                    <div class="nav-title">Factor 5: Build, Release, Run</div>
                                </a>
                            
                        
                        
                        
                            
                                <a href="/12-factor-app-website/factor-07-port-binding" class="footer-nav-btn next" aria-label="Next: Factor 7 - Port Binding">
                                    <div class="nav-direction">Next Factor</div>
                                    <div class="nav-title">Factor 7: Port Binding</div>
                                </a>
                            
                        
                    </nav>
                </article>
            </div>
        </div>
    </div>
</div>

<!-- Progress Indicator -->
<div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
</div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>The Modern 17-Factor App</h3>
                    <p>An evolution of the twelve-factor methodology for modern cloud-native applications</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/12-factor-app-website/">Home</a></li>
                        <li><a href="/12-factor-app-website/factor-01-codebase">Original 12 Factors</a></li>
                        <li><a href="/12-factor-app-website/factor-13-api-first">New 6 Factors</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="https://12factor.net" target="_blank" aria-label="Original 12-Factor App (opens in new tab)">Original 12-Factor App</a></li>
                        <li><a href="https://github.com/ifeatu/12-factor-app-website" target="_blank" aria-label="GitHub Repository (opens in new tab)">GitHub Repository</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 The Modern 17-Factor App. Built with Jekyll.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="/12-factor-app-website/assets/js/main.js"></script>
</body>
</html>