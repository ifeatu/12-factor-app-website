<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factor 18: Failure Isolation | The Modern 18-Factor App</title>
    <meta name="description" content="Contain failures and maintain system resilience">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/12-factor-app-website/assets/css/main.css">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SEO -->
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Factor 18: Failure Isolation | The Modern 18-Factor App</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Factor 18: Failure Isolation" />
<meta name="author" content="Pierre Brunelle" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Contain failures and maintain system resilience" />
<meta property="og:description" content="Contain failures and maintain system resilience" />
<link rel="canonical" href="https://pierrebrunelle.github.io/12-factor-app-website/factor-18-failure-isolation.html" />
<meta property="og:url" content="https://pierrebrunelle.github.io/12-factor-app-website/factor-18-failure-isolation.html" />
<meta property="og:site_name" content="The Modern 18-Factor App" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Factor 18: Failure Isolation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Pierre Brunelle"},"description":"Contain failures and maintain system resilience","headline":"Factor 18: Failure Isolation","url":"https://pierrebrunelle.github.io/12-factor-app-website/factor-18-failure-isolation.html"}</script>
<!-- End Jekyll SEO tag -->

    
    <!-- Feed -->
    <link type="application/atom+xml" rel="alternate" href="https://pierrebrunelle.github.io/12-factor-app-website/feed.xml" title="The Modern 18-Factor App" />
</head>
<body>
    <!-- Skip to main content link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="/12-factor-app-website/" class="brand-link" aria-label="The Modern 18-Factor App - Home">
                    <i class="fas fa-cube brand-icon" aria-hidden="true"></i>
                    <span class="brand-text">The Modern 18-Factor App</span>
                </a>
            </div>
            
            <div class="nav-menu" id="nav-menu" role="menubar">
                <a href="/12-factor-app-website/" class="nav-link " role="menuitem" aria-current="">
                    <i class="fas fa-home" aria-hidden="true"></i> Home
                </a>
                <div class="nav-dropdown" role="menuitem">
                    <a href="#" class="nav-link dropdown-toggle" aria-expanded="false" aria-haspopup="true" role="button" aria-label="Factors menu">
                        <i class="fas fa-list" aria-hidden="true"></i> Factors <i class="fas fa-chevron-down" aria-hidden="true"></i>
                    </a>
                    <div class="dropdown-content" role="menu" aria-label="Factors submenu">
                        <div class="dropdown-section">
                            <h4 role="presentation">Original 12 Factors</h4>
                            <a href="/12-factor-app-website/factor-01-codebase" role="menuitem">1. Codebase</a>
                            <a href="/12-factor-app-website/factor-02-dependencies" role="menuitem">2. Dependencies</a>
                            <a href="/12-factor-app-website/factor-03-config" role="menuitem">3. Config</a>
                            <a href="/12-factor-app-website/factor-04-backing-services" role="menuitem">4. Backing Services</a>
                            <a href="/12-factor-app-website/factor-05-build-release-run" role="menuitem">5. Build, Release, Run</a>
                            <a href="/12-factor-app-website/factor-06-processes" role="menuitem">6. Processes</a>
                            <a href="/12-factor-app-website/factor-07-port-binding" role="menuitem">7. Port Binding</a>
                            <a href="/12-factor-app-website/factor-08-concurrency" role="menuitem">8. Concurrency</a>
                            <a href="/12-factor-app-website/factor-09-disposability" role="menuitem">9. Disposability</a>
                            <a href="/12-factor-app-website/factor-10-dev-prod-parity" role="menuitem">10. Dev/Prod Parity</a>
                            <a href="/12-factor-app-website/factor-11-logs" role="menuitem">11. Logs</a>
                            <a href="/12-factor-app-website/factor-12-admin-processes" role="menuitem">12. Admin Processes</a>
                        </div>
                        <div class="dropdown-section">
                            <h4 role="presentation">New 6 Factors</h4>
                            <a href="/12-factor-app-website/factor-13-api-first" role="menuitem">13. API First</a>
                            <a href="/12-factor-app-website/factor-14-telemetry" role="menuitem">14. Telemetry</a>
                            <a href="/12-factor-app-website/factor-15-graphql-grpc" role="menuitem">15. GraphQL & gRPC</a>
                            <a href="/12-factor-app-website/factor-16-auth" role="menuitem">16. Authentication & Authorization</a>
                            <a href="/12-factor-app-website/factor-17-event-driven" role="menuitem">17. Event-Driven Architecture</a>
                            <a href="/12-factor-app-website/factor-18-failure-isolation" role="menuitem">18. Failure Isolation</a>
                        </div>
                    </div>
                </div>
                <a href="https://github.com/ifeatu/12-factor-app-website" target="_blank" class="nav-link" role="menuitem" aria-label="GitHub repository (opens in new tab)">
                    <i class="fab fa-github" aria-hidden="true"></i> GitHub
                </a>
            </div>
            
            <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="nav-menu">
                <span class="bar" aria-hidden="true"></span>
                <span class="bar" aria-hidden="true"></span>
                <span class="bar" aria-hidden="true"></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="main-content">
        <div class="factor-page">
    <!-- Factor Header -->
    <div class="factor-header">
        <div class="container">
            <div class="factor-nav">
                <a href="/12-factor-app-website/" class="back-link" aria-label="Back to overview page">
                    <i class="fas fa-arrow-left" aria-hidden="true"></i> Back to Overview
                </a>
                
                <nav class="factor-navigation" aria-label="Factor navigation">
                    
                        <a href="/12-factor-app-website/factor-17-event-driven" class="nav-btn prev-btn" aria-label="Previous factor: Event-Driven">
                            <i class="fas fa-chevron-left" aria-hidden="true"></i> Previous
                        </a>
                    
                    
                    
                </nav>
            </div>
            
            <div class="factor-title">
                
                
                    <div class="factor-number-circle">18</div>
                    <h1 class="factor-name">Failure Isolation</h1>
                
                
                
                    <p class="factor-description">Contain failures and maintain system resilience</p>
                
            </div>
        </div>
    </div>

    <!-- Factor Content -->
    <div class="factor-content">
        <div class="container">
            <div class="content-wrapper">
                <!-- Table of Contents -->
                <aside class="toc-sidebar" role="complementary" aria-label="Table of contents">
                    <div class="toc-container">
                        <h3>Table of Contents</h3>
                        <div id="toc"></div>
                    </div>
                </aside>
                
                <!-- Main Content -->
                <article class="factor-article" role="main">
                    <h1 id="factor-18-failure-isolation">Factor 18: Failure Isolation</h1>

<h2 id="design-for-partial-failure-with-circuit-breakers-and-bulkheads">Design for partial failure with circuit breakers and bulkheads</h2>

<h3 id="modern-principle">Modern Principle</h3>

<p>Distributed systems experience partial failures constantly. Applications must isolate failures to prevent cascade effects that bring down entire systems. This factor mandates patterns like circuit breakers, bulkheads, timeouts, and graceful degradation as first-class architectural concerns.</p>

<h4 id="circuit-breaker-pattern">Circuit Breaker Pattern</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Python implementation with py-breaker
</span><span class="kn">from</span> <span class="nn">pybreaker</span> <span class="kn">import</span> <span class="n">CircuitBreaker</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">class</span> <span class="nc">ServiceCircuitBreaker</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">failure_threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">recovery_timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">expected_exception</span><span class="o">=</span><span class="nb">Exception</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">breaker</span> <span class="o">=</span> <span class="n">CircuitBreaker</span><span class="p">(</span>
            <span class="n">fail_max</span><span class="o">=</span><span class="n">failure_threshold</span><span class="p">,</span>
            <span class="n">reset_timeout</span><span class="o">=</span><span class="n">recovery_timeout</span><span class="p">,</span>
            <span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">expected_exception</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">fallback_data</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">with_fallback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fallback_func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="o">@</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Wrap the original function with circuit breaker
</span>                    <span class="n">protected_func</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">breaker</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">protected_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># Circuit is open or function failed
</span>                    <span class="n">logger</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s">"Circuit breaker triggered: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">fallback_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">wrapper</span>
        <span class="k">return</span> <span class="n">decorator</span>

<span class="c1"># Usage example
</span><span class="n">user_service_breaker</span> <span class="o">=</span> <span class="n">ServiceCircuitBreaker</span><span class="p">(</span>
    <span class="n">failure_threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">recovery_timeout</span><span class="o">=</span><span class="mi">30</span>
<span class="p">)</span>

<span class="o">@</span><span class="n">user_service_breaker</span><span class="p">.</span><span class="n">with_fallback</span><span class="p">(</span><span class="k">lambda</span> <span class="n">user_id</span><span class="p">:</span> <span class="p">{</span><span class="s">"id"</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span> <span class="s">"name"</span><span class="p">:</span> <span class="s">"Unknown"</span><span class="p">,</span> <span class="s">"cached"</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
<span class="k">def</span> <span class="nf">get_user_profile</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
        <span class="sa">f</span><span class="s">"http://user-service/users/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">)</span>
    <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>

<span class="c1"># Hystrix-style command pattern
</span><span class="k">class</span> <span class="nc">GetUserCommand</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">user_id</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">fallback_response</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"id"</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
            <span class="s">"name"</span><span class="p">:</span> <span class="s">"Guest User"</span><span class="p">,</span>
            <span class="s">"source"</span><span class="p">:</span> <span class="s">"fallback"</span>
        <span class="p">}</span>
    
    <span class="o">@</span><span class="n">CircuitBreaker</span><span class="p">(</span><span class="n">fail_max</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">reset_timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
                <span class="sa">f</span><span class="s">"http://user-service/users/</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">user_id</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
                <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">timeout</span>
            <span class="p">)</span>
            
            <span class="c1"># Track metrics
</span>            <span class="n">latency</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="n">metrics</span><span class="p">.</span><span class="n">histogram</span><span class="p">(</span><span class="s">'user_service.latency'</span><span class="p">,</span> <span class="n">latency</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s">"User service returned </span><span class="si">{</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">Timeout</span><span class="p">:</span>
            <span class="n">metrics</span><span class="p">.</span><span class="n">counter</span><span class="p">(</span><span class="s">'user_service.timeout'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">metrics</span><span class="p">.</span><span class="n">counter</span><span class="p">(</span><span class="s">'user_service.error'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">raise</span>
    
    <span class="k">def</span> <span class="nf">fallback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">metrics</span><span class="p">.</span><span class="n">counter</span><span class="p">(</span><span class="s">'user_service.fallback'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">fallback_response</span>
</code></pre></div></div>

<h4 id="bulkhead-pattern">Bulkhead Pattern</h4>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// Go implementation with semaphores</span>
<span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"context"</span>
    <span class="s">"fmt"</span>
    <span class="s">"sync"</span>
    <span class="s">"time"</span>
<span class="p">)</span>

<span class="k">type</span> <span class="n">Bulkhead</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">semaphore</span> <span class="k">chan</span> <span class="k">struct</span><span class="p">{}</span>
    <span class="n">name</span>      <span class="kt">string</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">NewBulkhead</span><span class="p">(</span><span class="n">name</span> <span class="kt">string</span><span class="p">,</span> <span class="n">size</span> <span class="kt">int</span><span class="p">)</span> <span class="o">*</span><span class="n">Bulkhead</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&amp;</span><span class="n">Bulkhead</span><span class="p">{</span>
        <span class="n">semaphore</span><span class="o">:</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="k">struct</span><span class="p">{},</span> <span class="n">size</span><span class="p">),</span>
        <span class="n">name</span><span class="o">:</span>      <span class="n">name</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span><span class="n">Bulkhead</span><span class="p">)</span> <span class="n">Execute</span><span class="p">(</span><span class="n">ctx</span> <span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">fn</span> <span class="k">func</span><span class="p">()</span> <span class="kt">error</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
    <span class="k">select</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">b</span><span class="o">.</span><span class="n">semaphore</span> <span class="o">&lt;-</span> <span class="k">struct</span><span class="p">{}{}</span><span class="o">:</span>
        <span class="c">// Acquired semaphore</span>
        <span class="k">defer</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span> <span class="o">&lt;-</span><span class="n">b</span><span class="o">.</span><span class="n">semaphore</span> <span class="p">}()</span>
        
        <span class="c">// Execute with timeout</span>
        <span class="n">done</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="kt">error</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
        <span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
            <span class="n">done</span> <span class="o">&lt;-</span> <span class="n">fn</span><span class="p">()</span>
        <span class="p">}()</span>
        
        <span class="k">select</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">err</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="n">done</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">err</span>
        <span class="k">case</span> <span class="o">&lt;-</span><span class="n">ctx</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s">"bulkhead %s: context cancelled"</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="p">}</span>
        
    <span class="k">case</span> <span class="o">&lt;-</span><span class="n">ctx</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s">"bulkhead %s: timeout acquiring semaphore"</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c">// Resource pools for different workload types</span>
<span class="k">var</span> <span class="p">(</span>
    <span class="n">dbBulkhead</span>    <span class="o">=</span> <span class="n">NewBulkhead</span><span class="p">(</span><span class="s">"database"</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
    <span class="n">apiBulkhead</span>   <span class="o">=</span> <span class="n">NewBulkhead</span><span class="p">(</span><span class="s">"external-api"</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
    <span class="n">cacheBulkhead</span> <span class="o">=</span> <span class="n">NewBulkhead</span><span class="p">(</span><span class="s">"cache"</span><span class="p">,</span> <span class="m">20</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">HandleRequest</span><span class="p">(</span><span class="n">ctx</span> <span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">userID</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="n">User</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="c">// Isolate database calls</span>
    <span class="k">var</span> <span class="n">user</span> <span class="o">*</span><span class="n">User</span>
    <span class="n">err</span> <span class="o">:=</span> <span class="n">dbBulkhead</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="k">func</span><span class="p">()</span> <span class="kt">error</span> <span class="p">{</span>
        <span class="k">var</span> <span class="n">err</span> <span class="kt">error</span>
        <span class="n">user</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">fetchUserFromDB</span><span class="p">(</span><span class="n">userID</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">})</span>
    
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="k">return</span> <span class="no">nil</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Errorf</span><span class="p">(</span><span class="s">"database error: %w"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c">// Isolate external API calls with separate pool</span>
    <span class="k">var</span> <span class="n">enrichment</span> <span class="o">*</span><span class="n">UserEnrichment</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">apiBulkhead</span><span class="o">.</span><span class="n">Execute</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="k">func</span><span class="p">()</span> <span class="kt">error</span> <span class="p">{</span>
        <span class="k">var</span> <span class="n">err</span> <span class="kt">error</span>
        <span class="n">enrichment</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">fetchEnrichmentData</span><span class="p">(</span><span class="n">userID</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">err</span>
    <span class="p">})</span>
    
    <span class="c">// Graceful degradation - continue without enrichment</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="n">log</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"Failed to fetch enrichment: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
        <span class="n">enrichment</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">UserEnrichment</span><span class="p">{}</span> <span class="c">// Empty enrichment</span>
    <span class="p">}</span>
    
    <span class="n">user</span><span class="o">.</span><span class="n">Enrichment</span> <span class="o">=</span> <span class="n">enrichment</span>
     <span class="k">return</span> <span class="n">user</span><span class="p">,</span> <span class="no">nil</span>
 <span class="p">}</span>
</code></pre></div></div>

<h4 id="retry-with-backoff">Retry with Backoff</h4>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Node.js implementation</span>
<span class="kd">class</span> <span class="nx">RetryWithBackoff</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">maxRetries</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">maxRetries</span> <span class="o">||</span> <span class="mi">3</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">initialDelay</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">initialDelay</span> <span class="o">||</span> <span class="mi">100</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">maxDelay</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">maxDelay</span> <span class="o">||</span> <span class="mi">10000</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">factor</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">factor</span> <span class="o">||</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">jitter</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">jitter</span> <span class="o">||</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">async</span> <span class="nx">execute</span><span class="p">(</span><span class="nx">fn</span><span class="p">,</span> <span class="nx">context</span> <span class="o">=</span> <span class="p">{})</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">lastError</span><span class="p">;</span>
        
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">attempt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">attempt</span> <span class="o">&lt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">maxRetries</span><span class="p">;</span> <span class="nx">attempt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fn</span><span class="p">();</span>
                
                <span class="c1">// Success - record metrics</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">attempt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Success after </span><span class="p">${</span><span class="nx">attempt</span><span class="p">}</span><span class="s2"> retries`</span><span class="p">);</span>
                <span class="p">}</span>
                
                <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">lastError</span> <span class="o">=</span> <span class="nx">error</span><span class="p">;</span>
                
                <span class="c1">// Check if error is retryable</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isRetryable</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="o">||</span> <span class="nx">attempt</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">maxRetries</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
                <span class="p">}</span>
                
                <span class="c1">// Calculate delay with exponential backoff</span>
                <span class="kd">const</span> <span class="nx">delay</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">calculateDelay</span><span class="p">(</span><span class="nx">attempt</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Retry </span><span class="p">${</span><span class="nx">attempt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span><span class="s2">/</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">maxRetries</span><span class="p">}</span><span class="s2"> after </span><span class="p">${</span><span class="nx">delay</span><span class="p">}</span><span class="s2">ms`</span><span class="p">);</span>
                
                <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="nx">delay</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">throw</span> <span class="nx">lastError</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nx">isRetryable</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Don't retry client errors</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">response</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">400</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="c1">// Retry network and server errors</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="nx">calculateDelay</span><span class="p">(</span><span class="nx">attempt</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">delay</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">initialDelay</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">factor</span><span class="p">,</span> <span class="nx">attempt</span><span class="p">),</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">maxDelay</span>
        <span class="p">);</span>
        
        <span class="c1">// Add jitter to prevent thundering herd</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">jitter</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">delay</span> <span class="o">=</span> <span class="nx">delay</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">delay</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="nx">sleep</span><span class="p">(</span><span class="nx">ms</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">ms</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Usage with timeout</span>
<span class="kd">const</span> <span class="nx">retry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RetryWithBackoff</span><span class="p">({</span>
    <span class="na">maxRetries</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="na">initialDelay</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="na">factor</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">});</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">callExternalService</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">retry</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AbortController</span><span class="p">();</span>
        <span class="kd">const</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">controller</span><span class="p">.</span><span class="nx">abort</span><span class="p">(),</span> <span class="mi">5000</span><span class="p">);</span>
        
        <span class="k">try</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://api.example.com/endpoint</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
                <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
                <span class="na">signal</span><span class="p">:</span> <span class="nx">controller</span><span class="p">.</span><span class="nx">signal</span>
            <span class="p">});</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">`HTTP </span><span class="p">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeout</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="implementation-guidelines">Implementation Guidelines</h3>

<ol>
  <li>
    <p><strong>Timeout Budgets</strong></p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">TOTAL_TIMEOUT</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># seconds
</span>    
 <span class="n">timeout_budget</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s">'auth'</span><span class="p">:</span> <span class="n">TOTAL_TIMEOUT</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>      <span class="c1"># 3s
</span>     <span class="s">'database'</span><span class="p">:</span> <span class="n">TOTAL_TIMEOUT</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">,</span>   <span class="c1"># 9s
</span>     <span class="s">'external_api'</span><span class="p">:</span> <span class="n">TOTAL_TIMEOUT</span> <span class="o">*</span> <span class="mf">0.4</span><span class="p">,</span> <span class="c1"># 12s
</span>     <span class="s">'cache'</span><span class="p">:</span> <span class="n">TOTAL_TIMEOUT</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">,</span>      <span class="c1"># 3s
</span>     <span class="s">'buffer'</span><span class="p">:</span> <span class="n">TOTAL_TIMEOUT</span> <span class="o">*</span> <span class="mf">0.1</span>      <span class="c1"># 3s
</span> <span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Health Check Aggregation</strong></p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/health/ready'</span><span class="p">)</span>
 <span class="k">def</span> <span class="nf">readiness_check</span><span class="p">():</span>
     <span class="n">checks</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s">'database'</span><span class="p">:</span> <span class="n">check_with_timeout</span><span class="p">(</span><span class="n">check_database</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
         <span class="s">'cache'</span><span class="p">:</span> <span class="n">check_with_timeout</span><span class="p">(</span><span class="n">check_redis</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
         <span class="s">'external_api'</span><span class="p">:</span> <span class="n">check_with_timeout</span><span class="p">(</span><span class="n">check_api</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
     <span class="p">}</span>
        
     <span class="c1"># Partial failure is okay for non-critical services
</span>     <span class="n">critical_services</span> <span class="o">=</span> <span class="p">[</span><span class="s">'database'</span><span class="p">]</span>
     <span class="n">critical_healthy</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span>
         <span class="n">checks</span><span class="p">[</span><span class="n">service</span><span class="p">]</span> <span class="k">for</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">critical_services</span>
     <span class="p">)</span>
        
     <span class="n">status</span> <span class="o">=</span> <span class="s">'ready'</span> <span class="k">if</span> <span class="n">critical_healthy</span> <span class="k">else</span> <span class="s">'not ready'</span>
     <span class="n">status_code</span> <span class="o">=</span> <span class="mi">200</span> <span class="k">if</span> <span class="n">critical_healthy</span> <span class="k">else</span> <span class="mi">503</span>
        
     <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
         <span class="s">'status'</span><span class="p">:</span> <span class="n">status</span><span class="p">,</span>
         <span class="s">'checks'</span><span class="p">:</span> <span class="n">checks</span><span class="p">,</span>
         <span class="s">'timestamp'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="n">utcnow</span><span class="p">().</span><span class="n">isoformat</span><span class="p">()</span>
     <span class="p">}),</span> <span class="n">status_code</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="best-practices">Best Practices</h3>

<ol>
  <li><strong>Fail fast</strong> - Don’t wait for timeouts</li>
  <li><strong>Graceful degradation</strong> - Partial service better than none</li>
  <li><strong>Bulkhead critical resources</strong> - Isolate failure domains</li>
  <li><strong>Monitor circuit breaker state</strong> - Alert on open circuits</li>
  <li><strong>Test failure scenarios</strong> - Chaos engineering</li>
</ol>

<h3 id="key-takeaways">Key Takeaways</h3>

<ol>
  <li>Failures are inevitable in distributed systems</li>
  <li>Circuit breakers prevent cascade failures</li>
  <li>Bulkheads isolate resource exhaustion</li>
  <li>Timeouts prevent indefinite waiting</li>
  <li>Graceful degradation maintains user experience</li>
</ol>

<hr />

<h3 id="sources">Sources</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">https://pragprog.com/titles/mnee2/release-it-second-edition/</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://github.com/Netflix/Hystrix/wiki</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://martinfowler.com/bliki/CircuitBreaker.html</code></li>
  <li><code class="language-plaintext highlighter-rouge">https://docs.microsoft.com/en-us/azure/architecture/patterns/bulkhead</code></li>
</ul>

                    
                    <!-- Factor Navigation Footer -->
                    <nav class="factor-footer-nav" aria-label="Factor pagination">
                        
                            
                                <a href="/12-factor-app-website/factor-17-event-driven" class="footer-nav-btn prev" aria-label="Previous: Factor 17 - Event-Driven">
                                    <div class="nav-direction">Previous Factor</div>
                                    <div class="nav-title">Factor 17: Event-Driven</div>
                                </a>
                            
                        
                        
                        
                    </nav>
                </article>
            </div>
        </div>
    </div>
</div>

<!-- Progress Indicator -->
<div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
</div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>The Modern 18-Factor App</h3>
                    <p>An evolution of the twelve-factor methodology for modern cloud-native applications</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/12-factor-app-website/">Home</a></li>
                        <li><a href="/12-factor-app-website/factor-01-codebase">Original 12 Factors</a></li>
                        <li><a href="/12-factor-app-website/factor-13-api-first">New 6 Factors</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="https://12factor.net" target="_blank" aria-label="Original 12-Factor App (opens in new tab)">Original 12-Factor App</a></li>
                        <li><a href="https://github.com/ifeatu/12-factor-app-website" target="_blank" aria-label="GitHub Repository (opens in new tab)">GitHub Repository</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 The Modern 18-Factor App. Built with Jekyll.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="/12-factor-app-website/assets/js/main.js"></script>
</body>
</html>